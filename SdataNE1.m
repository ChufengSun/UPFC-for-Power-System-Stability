%data for New England Test case
disp('New England data')
%(bus#)( volt )( ang  )(  pgen )(  qgen )( pload )( qload )(gshunt)(bshunt)(bus type)
bus=[
   1   1.048  -9.43   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
   2   1.0505 -6.89   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
   3   1.0341 -9.73   0.0000   0.0000   3.2200   0.0240 0.00000 0.00000 3 99  -99 1.0   0     0;
   4   1.0116 -10.53  0.0000   0.0000   5.0000   1.8400 0.00000 1.00000 3 99  -99 1.0   0     0;
   5   1.0165 -9.38   0.0000   0.0000   0.0000   0.0000 0.00000 2.00000 3 99  -99 1.0   0     0;
   6   1.0172 -8.68   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99 -99  1.0  1.17  0.98;
   7   1.0067 -10.84  0.0000   0.0000   2.3380   8.4000 0.00000 0.00000 3 99  -99 1.0   0     0;
   8   1.0057 -11.34  0.0000   0.0000   5.2200   1.7600 0.00000 0.00000 3 99  -99 1.0   0     0;
   9   1.0322 -11.15  0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  10   1.0235 -6.31   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  11   1.0201 -7.12   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  12   1.0072 -7.14   0.0000   0.0000   0.0850   0.8800 0.00000 0.00000 3 99  -99 1.0   0     0;
  13   1.0207 -7.02   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  14   1.0181 -8.66   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  15   1.0194 -9.06   0.0000   0.0000   3.2000   1.5300 0.00000 0.00000 3 99  -99 1.0   0     0;
  16   1.0346 -7.66   0.0000   0.0000   3.2940   3.2300 0.00000 0.00000 3 99  -99 1.0   0     0;
  17   1.0365 -8.65   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  18   1.0343 -9.49   0.0000   0.0000   1.5800   0.3000 0.00000 0.00000 3 99  -99 1.0   0     0;
  19   1.0509 -3.04   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  20   0.9914 -4.45   0.0000   0.0000   6.8000   1.0300 0.00000 0.00000 3 99  -99 1.0   0     0;
  21   1.0337 -5.26   0.0000   0.0000   2.7400   1.1500 0.00000 0.00000 3 99  -99 1.0   0     0;
  22   1.0509 -0.82   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  23   1.0459 -1.02   0.0000   0.0000   2.4750   0.8460 0.00000 0.00000 3 99  -99 1.0   0     0;
  24   1.0399 -7.54   0.0000   0.0000   3.0860   -0.922 0.00000 0.00000 3 99  -99 1.0   0     0;
  25   1.0587 -5.51   0.0000   0.0000   2.2400   0.4720 0.00000 0.00000 3 99  -99 1.0   0     0;
  26   1.0536 -6.77   0.0000   0.0000   1.3900   0.1700 0.00000 0.00000 3 99  -99 1.0   0     0;
  27   1.0399 -8.78   0.0000   0.0000   2.8100   0.7550 0.00000 0.00000 3 99  -99 1.0   0     0;
  28   1.0509 -3.27   0.0000   0.0000   2.0600   0.2760 0.00000 0.00000 3 99  -99 1.0   0     0;
  29   1.0505 -0.51   0.0000   0.0000   2.8350   1.2690 0.00000 0.00000 3 99  -99 1.0   0     0;
  30   1.0475   1.0   2.5000   1.3621   0.0000   0.0000 0.00000 0.00000 2  8   -5 1.0   0     0;
  31   1.0400 -10.0   5.7293   1.7036   0.0920   0.0460 0.00000 0.00000 2  8   -5 1.0   0     0;
  32   0.9831  1.63   6.5000   1.7590   0.0000   0.0000 0.00000 0.00000 2  8   -5 1.0   0     0;
  33   0.9972  2.18   6.3200   1.0335   0.0000   0.0000 0.00000 0.00000 2  8   -5 1.0   0     0;
  34   1.0123  0.74   5.0800   1.6400   0.0000   0.0000 0.00000 0.00000 2  4   -3 1.0   0     0;
  35   1.0493  4.14   6.5000   2.0884   0.0000   0.0000 0.00000 0.00000 2  8   -5 1.0   0     0;
  36   1.0635  6.83   5.6000   0.9688   0.0000   0.0000 0.00000 0.00000 2  8   -5 1.0   0     0;
  37   1.0278  1.26   5.4000  -0.0444   0.0000   0.0000 0.00000 0.00000 2  8   -5 1.0   0     0;
  38   1.0265  6.55   8.3000   0.1939   0.0000   0.0000 0.00000 0.00000 2  8   -5 1.0   0     0;
  39   1.0300  0      10.000   0.6846   11.040   2.5000 0.00000 0.00000 1  15 -10 1.0   0     0];

%b#1 b#2( res  )(  rea  )(charg )(tap )(phase)
line = [
   1   2 0.00350  0.04110 0.69870 0.0000 0   0    0    0;
   1  39 0.00100  0.02500 0.75000 0.0000 0   0    0    0;
   2   3 0.00130  0.01510 0.25720 0.0000 0   0    0    0;
   2  25 0.00700  0.00860 0.14600 0.0000 0   0    0    0;
   2  30 0.00000  0.01810 0.00000 1.0250 0   0    0    0;
   3   4 0.00130  0.02130 0.22140 0.0000 0   0    0    0;
   3  18 0.00110  0.01330 0.21380 0.0000 0   0    0    0;
   4   5 0.00080  0.01280 0.13420 0.0000 0   0    0    0;
   4  14 0.00080  0.01290 0.13820 0.0000 0   0    0    0;
   5   8 0.00080  0.01120 0.14760 0.0000 0   0    0    0;
   6   5 0.00020  0.00260 0.04340 0.0000 0   0    0    0;
   6   7 0.00060  0.00920 0.11300 0.0000 0   0    0    0;
   6  11 0.00070  0.00820 0.13890 0.0000 0   0    0    0;
   7   8 0.00040  0.00460 0.07800 0.0000 0   0    0    0;
   8   9 0.00230  0.03630 0.38040 0.0000 0   0    0    0;
   9  39 0.00100  0.02500 1.20000 0.0000 0   0    0    0;
  10  11 0.00040  0.00430 0.07290 0.0000 0   0    0    0;
  10  13 0.00040  0.00430 0.07290 0.0000 0   0    0    0;
  10  32 0.00000  0.02000 0.00000 1.0700 0   0    0    0;
  12  11 0.00160  0.04350 0.00000 1.0060 0   0    0    0;
  12  13 0.00160  0.04350 0.00000 1.0060 0   0    0    0;
  13  14 0.00090  0.01010 0.17230 0.0000 0   0    0    0;
  14  15 0.00180  0.02170 0.36600 0.0000 0   0    0    0;
  15  16 0.00090  0.00940 0.17100 0.0000 0   0    0    0;
  16  17 0.00070  0.00890 0.13420 0.0000 0   0    0    0;
  16  19 0.00160  0.01950 0.30400 0.0000 0   0    0    0;
  16  21 0.00080  0.01350 0.25480 0.0000 0   0    0    0;
  16  24 0.00030  0.00590 0.06800 0.0000 0   0    0    0;
  17  18 0.00070  0.00820 0.13190 0.0000 0   0    0    0;
  17  27 0.00130  0.01730 0.32160 0.0000 0   0    0    0;
  19  33 0.00070  0.01420 0.00000 1.0700 0   0    0    0;
  19  20 0.00070  0.01380 0.00000 1.0600 0   0    0    0;
  20  34 0.00090  0.01800 0.00000 1.0090 0   0    0    0;
  21  22 0.00080  0.01400 0.25650 0.0000 0   0    0    0;
  22  23 0.00060  0.00960 0.18460 0.0000 0   0    0    0;
  22  35 0.00000  0.01430 0.00000 1.0250 0   0    0    0;
  23  24 0.00220  0.03500 0.36100 0.0000 0   0    0    0;
  23  36 0.00050  0.02720 0.00000 1.0000 0   0    0    0;
  25  26 0.00320  0.03230 0.51300 0.0000 0   0    0    0;
  25  37 0.00060  0.02320 0.00000 1.0250 0   0    0    0;
  26  27 0.00140  0.01470 0.23960 0.0000 0   0    0    0;
  26  28 0.00430  0.04740 0.78020 0.0000 0   0    0    0;
  26  29 0.00570  0.06250 1.02900 0.0000 0   0    0    0;
  28  29 0.00140  0.01510 0.24900 0.0000 0   0    0    0;
  29  38 0.00080  0.01560 0.00000 1.0250 0   0    0    0;
  31   6 0.00000  0.02500 0.00000 1.0000 0  1.2  0.8  0.05;];


mac_con = [...
  1  30  100.0 0.0125 0.0  0.1000 0.0310 0 10.2  0 0.069 0.0310 0  1.500 0 42.00 100 0 30 0 0;
  2  31  100.0 0.0350 0.0  0.2950 0.0697 0 6.56  0 0.282 0.0697 0  1.500 0 30.30 100 0 31 0 0;
  3  32  100.0 0.0304 0.0  0.2495 0.0531 0 5.700 0 0.237 0.0531 0  1.500 0 35.80 100 0 32 0 0;
  4  33  100.0 0.0295 0.0  0.2620 0.0436 0 5.690 0 0.258 0.0436 0  1.500 0 28.60 100 0 33 0 0;
  5  34  100.0 0.0540 0.0  0.6700 0.1320 0 5.400 0 0.620 0.1320 0  0.440 0 26.00 100 0 34 0 0;
  6  35  100.0 0.0224 0.0  0.2540 0.0500 0 7.300 0 0.241 0.0500 0  0.400 0 34.80 100 0 35 0 0;
  7  36  100.0 0.0322 0.0  0.2950 0.0490 0 5.660 0 0.292 0.0490 0  1.500 0 26.40 100 0 36 0 0;
  8  37  100.0 0.0280 0.0  0.2900 0.0570 0 6.700 0 0.280 0.0570 0  0.410 0 24.30 100 0 37 0 0;
  9  38  100.0 0.0298 0.0  0.2106 0.0570 0 4.790 0 0.205 0.0570 0  1.960 0 34.50 100 0 38 0 0;
  10 39  100.0 0.0030 0.0  0.0200 0.0060 0 7.000 0 0.019 0.0060 0  0.700 0 500.0 50 0 39 0 0];


exc_con =[
1 1  0  5.00 0.060  0.000 0.000 5   -5    -0.05 0.25  1.7 0.5  3 2.0   0 0.04  1.000 0  0 
1 2  0  6.20 0.050  0.000 0.000 5   -5     0.63 0.410 3   0.66 4 0.88  0 0.06  0.500 0  0
1 3  0  5.00 0.060  0.000 0.000 5   -5    -0.02 0.500 3   0.13 4 0.34  0 0.08  1.000 0  0
1 4  0  5.00 0.060  0.000 0.000 5   -5    -0.05 0.500 3   0.08 4 0.31  0 0.08  1.000 0  0
1 5  0 40.00 0.020  0.000 0.000 10  -10   -0.04 0.785 3   0.03 4 0.91  0 0.03  1.000 0  0
1 6  0  5.00 0.020  0.000 0.000 5   -5     1.00 0.471 3   0.08 4 0.25  0 0.08  1.25  0  0
1 7  0 40.00 0.020  0.000 0.000 6.5 -6.5   1.00 0.730 3   0.03 4 0.74  0 0.03  1.000 0  0
1 8  0  5.00 0.020  0.000 0.000 5   -5    -0.05 0.528 3   0.09 4 0.28  0 0.09  1.260 0  0
1 9  0 40.00 0.020  0.000 0.000 10.5 -10.5 1.00 1.400 3   0.03 4 0.85  0 0.03  1.000 0  0];

%zou =0;
%zou_1=13;
%if zou==1
    %if zou_1 == 13
        
        %load_con = [13  0  0   0  0];        
        %disp('0.1 constant current load')
        %svc_con = [1  13    100  100  -100 200  0.05];
   % elseif zou_1 ==15
        
       % load_con = [15  0  0   0  0];        
        %disp('0.1 constant current load')
       % svc_con = [1  15    100  100  -100 150  0.05];
    %end
        
%elseif zou==2
    %load_con = [3  0  0   0  0;
               %7 0  0   0  0];%%%%%%%%%%%%%%%
    %svc_con = [1  3    100  100  -100 100  0.05;%250 150 100
              % 2  7   100  100  -100 65  0.02];%65 60
%end


sw_con = [...
0    0    0    0    0    0    0.01;%sets intitial time step
0.1  3    4    0    0    0    0.01; %apply three phase fault at bus 3 line 3-4
0.15 0    0    0    0    0    0.01; %clear fault at bus 3
0.18 0    0    0    0    0    0.01; %clear remote end
0.50 0    0    0    0    0    0.01; % increase time step 
1.0  0    0    0    0    0    0.01; % increase time step
10  0    0    0    0    0    0]; % end simulation

ibus_con = zeros(length(mac_con(:,1)),1);
ibus_con(10) = 1;

